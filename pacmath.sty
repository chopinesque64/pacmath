\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{pacmath}[2019-08-03 Pacmath]

\RequirePackage{amsmath}
\RequirePackage{pict2e}

\makeatletter

% Internal structure.
\@ifdefinable\if@pac@eye@{\newif\if@pac@eye@}
\@ifdefinable\if@pac@mouth@{\newif\if@pac@mouth@}

% Drawing macros.
% Arguments: #1 -- font style
%            #2 -- line thickness
%            #3 -- eye diameter


%%% Large Pacman %%%
\def\@pac@Large@man@X{2.61}
\def\@pac@Large@man@Y{1.5}
\def\@pac@Large@man@T{3}
\def\@pac@Large@man@regionA@control@X{1.305}
\def\@pac@Large@man@regionA@control@Y{0.75}
\def\@pac@Large@man@regionB@control@X{1.74}
\def\@pac@Large@man@regionB@control@Y{3}
\def\@pac@Large@man@regionC@control@X{3.45}
\def\@pac@Large@man@regionC@control@Y{0}
\def\@pac@Large@man@eye@X{0.25}
\def\@pac@Large@man@eye@Y{1.75}

\newcommand*\@pac@Large@man[3]{%
    \setlength\unitlength{\fontdimen 22 #1\tw@}%
    \vrule \@width\z@ \@height 5\unitlength \@depth\thr@@\unitlength%
    \begin{picture}(6,2)(-3,-1)
        \linethickness{#2\p@}%
        \qbezier(0, 0)(\@pac@Large@man@regionA@control@X, \@pac@Large@man@regionA@control@Y)(\@pac@Large@man@X, \@pac@Large@man@Y)%
        \qbezier(\@pac@Large@man@X, \@pac@Large@man@Y)(\@pac@Large@man@regionB@control@X, \@pac@Large@man@regionB@control@Y)(0, \@pac@Large@man@T)%
        \qbezier(0, \@pac@Large@man@T)(-\@pac@Large@man@regionB@control@X, \@pac@Large@man@regionB@control@Y)(-\@pac@Large@man@X, \@pac@Large@man@Y)%
        \qbezier(-\@pac@Large@man@X, \@pac@Large@man@Y)(-\@pac@Large@man@regionC@control@X, 0)(-\@pac@Large@man@X, -\@pac@Large@man@Y)%
        \qbezier(-\@pac@Large@man@X, -\@pac@Large@man@Y)(-\@pac@Large@man@regionB@control@X, -\@pac@Large@man@regionB@control@Y)(0, -\@pac@Large@man@T)%
        \qbezier(0, -\@pac@Large@man@T)(\@pac@Large@man@regionB@control@X, -\@pac@Large@man@regionB@control@Y)(\@pac@Large@man@X, -\@pac@Large@man@Y)%
        \qbezier(\@pac@Large@man@X, -\@pac@Large@man@Y)(\@pac@Large@man@regionA@control@X, -\@pac@Large@man@regionA@control@Y)(0, 0)%
        \if@pac@eye@
            \put(\@pac@Large@man@eye@X, \@pac@Large@man@eye@Y){\circle*{#3}}%
        \fi
    \end{picture}
}


%%% Small Pacman %%%
\def\@pac@Small@man@X{1.305}
\def\@pac@Small@man@Y{0.75}
\def\@pac@Small@man@T{1.5}
\def\@pac@Small@man@regionA@control@X{0.6525}
\def\@pac@Small@man@regionA@control@Y{0.375}
\def\@pac@Small@man@regionB@control@X{0.87}
\def\@pac@Small@man@regionB@control@Y{1.5}
\def\@pac@Small@man@regionC@control@X{1.725}
\def\@pac@Small@man@regionC@control@Y{0}
\def\@pac@Small@man@eye@X{0.15}
\def\@pac@Small@man@eye@Y{0.80}

\newcommand*\@pac@Small@man[3]{%
    \setlength\unitlength{\fontdimen 22 #1\tw@}%
    \vrule \@width\z@ \@height\z@ \@depth\@ne\unitlength%
    \begin{picture}(3.5,2)(-2,-1)
        \linethickness{#2\p@}%
        \qbezier(0, 0)(\@pac@Small@man@regionA@control@X, \@pac@Small@man@regionA@control@Y)(\@pac@Small@man@X, \@pac@Small@man@Y)%
        \qbezier(\@pac@Small@man@X, \@pac@Small@man@Y)(\@pac@Small@man@regionB@control@X, \@pac@Small@man@regionB@control@Y)(0, \@pac@Small@man@T)%
        \qbezier(0, \@pac@Small@man@T)(-\@pac@Small@man@regionB@control@X, \@pac@Small@man@regionB@control@Y)(-\@pac@Small@man@X, \@pac@Small@man@Y)%
        \qbezier(-\@pac@Small@man@X, \@pac@Small@man@Y)(-\@pac@Small@man@regionC@control@X, 0)(-\@pac@Small@man@X, -\@pac@Small@man@Y)%
        \qbezier(-\@pac@Small@man@X, -\@pac@Small@man@Y)(-\@pac@Small@man@regionB@control@X, -\@pac@Small@man@regionB@control@Y)(0, -\@pac@Small@man@T)%
        \qbezier(0, -\@pac@Small@man@T)(\@pac@Small@man@regionB@control@X, -\@pac@Small@man@regionB@control@Y)(\@pac@Small@man@X, -\@pac@Small@man@Y)%
        \qbezier(\@pac@Small@man@X, -\@pac@Small@man@Y)(\@pac@Small@man@regionA@control@X, -\@pac@Small@man@regionA@control@Y)(0, 0)%
        \if@pac@eye@
            \put(\@pac@Small@man@eye@X, \@pac@Small@man@eye@Y){\circle*{#3}}%
        \fi
    \end{picture}
}


%%% Large Ghost %%%
\def\@pac@Large@ghost@body@height{6}
\def\@pac@Large@ghost@body@arc@X{3}
\def\@pac@Large@ghost@body@arc@Y{9.25}
\def\@pac@Large@ghost@eyeL@X{4.35}
\def\@pac@Large@ghost@eyeR@X{2.50}
\def\@pac@Large@ghost@eye@Y{4.5}

\def\@pac@Large@ghost@cloth@outer@control@Y{0.25}
\def\@pac@Large@ghost@cloth@inner@control@Y{1}

\def\@pac@Large@ghost@clothA@X{1}
\def\@pac@Large@ghost@clothA@Y{1}
\def\@pac@Large@ghost@clothA@control@X{.25}

\def\@pac@Large@ghost@clothB@X{2}
\def\@pac@Large@ghost@clothB@control@X{1.5}

\def\@pac@Large@ghost@clothC@X{3}
\def\@pac@Large@ghost@clothC@Y{1}
\def\@pac@Large@ghost@clothC@control@X{2.5}

\def\@pac@Large@ghost@clothD@X{4}
\def\@pac@Large@ghost@clothD@control@X{3.5}

\def\@pac@Large@ghost@clothE@X{5}
\def\@pac@Large@ghost@clothE@Y{1}
\def\@pac@Large@ghost@clothE@control@X{4.5}

\def\@pac@Large@ghost@clothF@X{6}
\def\@pac@Large@ghost@clothF@control@X{5.75}

\newcommand*\@pac@Large@ghost[3]{%
    \setlength\unitlength{\fontdimen 22 #1\tw@}%
    \vrule \@width\z@ \@height 5\unitlength \@depth\thr@@\unitlength%
    \begin{picture}(10,4)(-3,2.5)
        \linethickness{#2\p@}%
        \put(0, 0){\line(0, \@pac@Large@ghost@body@height){\@pac@Large@ghost@body@height}}
        \qbezier(0, \@pac@Large@ghost@body@height)(\@pac@Large@ghost@body@arc@X, \@pac@Large@ghost@body@arc@Y)(\@pac@Large@ghost@body@height, \@pac@Large@ghost@body@height)
        \put(\@pac@Large@ghost@body@height, 0){\line(0, \@pac@Large@ghost@body@height){\@pac@Large@ghost@body@height}}
        \qbezier(0,0)(\@pac@Large@ghost@clothA@control@X, \@pac@Large@ghost@cloth@outer@control@Y)(\@pac@Large@ghost@clothA@X, \@pac@Large@ghost@clothA@Y)
        \qbezier(\@pac@Large@ghost@clothA@X, \@pac@Large@ghost@clothA@Y)(\@pac@Large@ghost@clothB@control@X, \@pac@Large@ghost@cloth@inner@control@Y)(\@pac@Large@ghost@clothB@X, 0)
        \qbezier(\@pac@Large@ghost@clothB@X, 0)(\@pac@Large@ghost@clothC@control@X, \@pac@Large@ghost@cloth@inner@control@Y)(\@pac@Large@ghost@clothC@X, \@pac@Large@ghost@clothC@Y)
        \qbezier(\@pac@Large@ghost@clothC@X, \@pac@Large@ghost@clothC@Y)(\@pac@Large@ghost@clothD@control@X, \@pac@Large@ghost@cloth@inner@control@Y)(\@pac@Large@ghost@clothD@X, 0)
        \qbezier(\@pac@Large@ghost@clothD@X, 0)(\@pac@Large@ghost@clothE@control@X,\@pac@Large@ghost@cloth@inner@control@Y)(\@pac@Large@ghost@clothE@X, \@pac@Large@ghost@clothE@Y)
        \qbezier(\@pac@Large@ghost@clothE@X, \@pac@Large@ghost@clothE@Y)(\@pac@Large@ghost@clothF@control@X, \@pac@Large@ghost@cloth@outer@control@Y)(\@pac@Large@ghost@clothF@X, 0)
        \if@pac@eye@
            \put(\@pac@Large@ghost@eyeL@X, \@pac@Large@ghost@eye@Y){\circle*{#3}}%
            \put(\@pac@Large@ghost@eyeR@X, \@pac@Large@ghost@eye@Y){\circle*{#3}}%
        \fi
    \end{picture}
}


%%% Small Ghost %%%
\def\@pac@Small@ghost@body@height{3}
\def\@pac@Small@ghost@body@arc@X{1.5}
\def\@pac@Small@ghost@body@arc@Y{5}
\def\@pac@Small@ghost@eyeL@X{2.125}
\def\@pac@Small@ghost@eyeR@X{1.275}
\def\@pac@Small@ghost@eye@Y{2.25}

\def\@pac@Small@ghost@cloth@outer@control@Y{0.2}
\def\@pac@Small@ghost@cloth@inner@control@Y{0.9}

\def\@pac@Small@ghost@clothA@X{0.5}
\def\@pac@Small@ghost@clothA@Y{0.5}
\def\@pac@Small@ghost@clothA@control@X{0.25}

\def\@pac@Small@ghost@clothB@X{1.5}
\def\@pac@Small@ghost@clothB@control@X{1}

\def\@pac@Small@ghost@clothC@X{2.5}
\def\@pac@Small@ghost@clothC@Y{0.5}
\def\@pac@Small@ghost@clothC@control@X{2}

\def\@pac@Small@ghost@clothD@X{3}
\def\@pac@Small@ghost@clothD@control@X{3}

\newcommand*\@pac@Small@ghost[3]{%
    \setlength\unitlength{\fontdimen 22 #1\tw@}%
    \vrule \@width\z@ \@height\z@ \@depth\@ne\unitlength%
    \begin{picture}(3.5,2)(0,1)
        \linethickness{#2\p@}%
        \put(0, 0){\line(0, \@pac@Small@ghost@body@height){\@pac@Small@ghost@body@height}}
        \qbezier(0, \@pac@Small@ghost@body@height)(\@pac@Small@ghost@body@arc@X, \@pac@Small@ghost@body@arc@Y)(\@pac@Small@ghost@body@height, \@pac@Small@ghost@body@height)
        \put(\@pac@Small@ghost@body@height, 0){\line(0, \@pac@Small@ghost@body@height){\@pac@Small@ghost@body@height}}
        \qbezier(0,0)(\@pac@Small@ghost@clothA@control@X, \@pac@Small@ghost@cloth@outer@control@Y)(\@pac@Small@ghost@clothA@X, \@pac@Small@ghost@clothA@Y)
        \qbezier(\@pac@Small@ghost@clothA@X, \@pac@Small@ghost@clothA@Y)(\@pac@Small@ghost@clothB@control@X, \@pac@Small@ghost@cloth@inner@control@Y)(\@pac@Small@ghost@clothB@X, 0)
        \qbezier(\@pac@Small@ghost@clothB@X, 0)(\@pac@Small@ghost@clothC@control@X, \@pac@Small@ghost@cloth@inner@control@Y)(\@pac@Small@ghost@clothC@X, \@pac@Small@ghost@clothC@Y)
        \qbezier(\@pac@Small@ghost@clothC@X, \@pac@Small@ghost@clothC@Y)(\@pac@Small@ghost@clothD@control@X, \@pac@Small@ghost@cloth@outer@control@Y)(\@pac@Small@ghost@clothD@X, 0)
        \if@pac@eye@
            \put(\@pac@Small@ghost@eyeL@X, \@pac@Small@ghost@eye@Y){\circle*{#3}}
            \put(\@pac@Small@ghost@eyeR@X, \@pac@Small@ghost@eye@Y){\circle*{#3}}
        \fi
    \end{picture}
}


% Math mode verification.
\newcommand*\@pac@if@bold@math{%
    \def\@tempa{bold}%
    \ifx\math@version\@tempa
        \expandafter\@firstoftwo
    \else
        \expandafter\@secondoftwo
    \fi
}

% Mode-selection backend.
\def\@pac@Large@bold@textfont@thickness{0.95}
\def\@pac@Large@bold@textfont@eye{}
\def\@pac@Small@bold@textfont@thickness{0.60}
\def\@pac@Small@bold@textfont@eye{0.45}
\def\@pac@Small@bold@scriptfont@thickness{0.2}
\def\@pac@Small@bold@scriptfont@eye{0.01}
\def\@pac@Small@bold@sscriptfont@thickness{0.01}
\def\@pac@Small@bold@sscriptfont@eye{0}

\def\@pac@Large@textfont@thickness{0.82}
\def\@pac@Large@textfont@eye{}
\def\@pac@Small@textfont@thickness{0.55}
\def\@pac@Small@textfont@eye{0.45}
\def\@pac@Small@scriptfont@thickness{0.2}
\def\@pac@Small@scriptfont@eye{0.4}
\def\@pac@Small@sscriptfont@thickness{0.01}
\def\@pac@Small@sscriptfont@eye{0.2}

\newcommand*\@pac@mathman{%
    \mathop{%
        \@pac@if@bold@math{%
            \mathchoice{%
                \@pac@Small@man \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@man \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@man \scriptfont {\@pac@Small@bold@scriptfont@thickness}{\@pac@Small@bold@scriptfont@eye}%
            }{%
                \@pac@Small@man \scriptscriptfont {\@pac@Small@bold@sscriptfont@thickness}{\@pac@Small@bold@sscriptfont@eye}%
            }%
        }{%
            \mathchoice{%
                \@pac@Small@man \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@man \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@man \scriptfont {\@pac@Small@scriptfont@thickness}{\@pac@Small@scriptfont@eye}%
            }{%
                \@pac@Small@man \scriptscriptfont {\@pac@Small@sscriptfont@thickness}{\@pac@Small@sscriptfont@eye}%
            }%
        }%
    }% \displaylimits % as per default
}

  \newcommand*\@pac@big@mathman{%
    \mathop{%
        \@pac@if@bold@math{%
            \mathchoice{%
                \@pac@Large@man \textfont {\@pac@Large@bold@textfont@thickness}{}%
            }{%
                \@pac@Small@man \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@man \scriptfont {\@pac@Small@bold@scriptfont@thickness}{\@pac@Small@bold@scriptfont@eye}%
            }{%
                \@pac@Small@man \scriptscriptfont {\@pac@Small@bold@sscriptfont@thickness}{\@pac@Small@bold@sscriptfont@eye}%
            }%
        }{%
            \mathchoice{%
                \@pac@Large@man \textfont {\@pac@Large@textfont@thickness}{}%
            }{%
                \@pac@Small@man \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@man \scriptfont {\@pac@Small@scriptfont@thickness}{\@pac@Small@scriptfont@eye}%
            }{%
                \@pac@Small@man \scriptscriptfont {\@pac@Small@sscriptfont@thickness}{\@pac@Small@sscriptfont@eye}%
            }%
        }%
    }% \displaylimits % as per default
}

\newcommand*\@pac@mathghost{%
    \mathop{%
        \@pac@if@bold@math{%
            \mathchoice{%
                \@pac@Small@ghost \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@ghost \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@ghost \scriptfont {\@pac@Small@bold@scriptfont@thickness}{\@pac@Small@bold@scriptfont@eye}%
            }{%
                \@pac@Small@ghost \scriptscriptfont {\@pac@Small@bold@sscriptfont@thickness}{\@pac@Small@bold@sscriptfont@eye}%
            }%
        }{%
            \mathchoice{%
                \@pac@Small@ghost \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@ghost \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@ghost \scriptfont {\@pac@Small@scriptfont@thickness}{\@pac@Small@scriptfont@eye}%
            }{%
                \@pac@Small@ghost \scriptscriptfont {\@pac@Small@sscriptfont@thickness}{\@pac@Small@sscriptfont@eye}%
            }%
        }%
    }% \displaylimits % as per default
}

\newcommand*\@pac@big@mathghost{%
    \mathop{%
        \@pac@if@bold@math{%
            \mathchoice{%
                \@pac@Large@bold@ghost \textfont {\@pac@Large@bold@textfont@thickness}{}%
            }{%
                \@pac@Small@ghost \textfont {\@pac@Small@bold@textfont@thickness}{\@pac@Small@bold@textfont@eye}%
            }{%
                \@pac@Small@ghost \scriptfont {\@pac@Small@bold@scriptfont@thickness}{\@pac@Small@bold@scriptfont@eye}%
            }{%
                \@pac@Small@ghost \scriptscriptfont {\@pac@Small@bold@sscriptfont@thickness}{\@pac@Small@bold@sscriptfont@eye}%
            }%
        }{%
            \mathchoice{%
                \@pac@Large@ghost \textfont {\@pac@Large@textfont@thickness}{}%
            }{%
                \@pac@Small@ghost \textfont {\@pac@Small@textfont@thickness}{\@pac@Small@textfont@eye}%
            }{%
                \@pac@Small@ghost \scriptfont {\@pac@Small@scriptfont@thickness}{\@pac@Small@scriptfont@eye}%
            }{%
                \@pac@Small@ghost \scriptscriptfont {\@pac@Small@sscriptfont@thickness}{\@pac@Small@sscriptfont@eye}%
            }%
        }%
    }% \displaylimits % as per default
}

% User-level commands.
\newcommand*\pacman{
    \@ifstar
        {\@pac@eye@false \@pac@mathman}%
        {\@pac@eye@true  \@pac@mathman}%
}
\newcommand*\bigpacman{
    \@ifstar
        {\@pac@eye@false \@pac@big@mathman}%
        {\@pac@eye@true  \@pac@big@mathman}%
}

\newcommand*\pacghost{
    \@ifstar
        {\@pac@eye@false \@pac@mathghost}%
        {\@pac@eye@true  \@pac@mathghost}%
}
\newcommand*\bigpacghost{
    \@ifstar
        {\@pac@eye@false \@pac@big@mathghost}%
        {\@pac@eye@true  \@pac@big@mathghost}%
}
\makeatother
